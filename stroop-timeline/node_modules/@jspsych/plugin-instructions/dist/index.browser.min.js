var jsPsychInstructions=function(r){"use strict";var f="2.1.0";const P={name:"instructions",version:f,parameters:{pages:{type:r.ParameterType.HTML_STRING,default:void 0,array:!0},key_forward:{type:r.ParameterType.KEY,default:"ArrowRight"},key_backward:{type:r.ParameterType.KEY,default:"ArrowLeft"},allow_backward:{type:r.ParameterType.BOOL,default:!0},allow_keys:{type:r.ParameterType.BOOL,default:!0},show_clickable_nav:{type:r.ParameterType.BOOL,default:!1},show_page_number:{type:r.ParameterType.BOOL,default:!1},page_label:{type:r.ParameterType.STRING,default:"Page"},button_label_previous:{type:r.ParameterType.STRING,default:"Previous"},button_label_next:{type:r.ParameterType.STRING,default:"Next"},on_page_change:{type:r.ParameterType.FUNCTION,pretty_name:"Page change callback",default:function(k){}}},data:{view_history:{type:r.ParameterType.COMPLEX,array:!0,nested:{page_index:{type:r.ParameterType.INT},viewing_time:{type:r.ParameterType.INT}}},rt:{type:r.ParameterType.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class v{constructor(t){this.jsPsych=t}trial(t,e){var i=0,s=[],h=performance.now(),p=h;function y(){this.id==="jspsych-instructions-back"?a():this.id==="jspsych-instructions-next"&&n()}function u(){var o=e.pages[i],_="";if(e.show_page_number&&(_="<span style='margin: 0 1em;' class='jspsych-instructions-pagenum'>"+e.page_label+" "+(i+1)+"/"+e.pages.length+"</span>"),e.show_clickable_nav){var d="<div class='jspsych-instructions-nav' style='padding: 10px 0px;'>";if(e.allow_backward){var m=i>0?"":"disabled='disabled'";d+="<button id='jspsych-instructions-back' class='jspsych-btn' style='margin-right: 5px;' "+m+">&lt; "+e.button_label_previous+"</button>"}e.pages.length>1&&e.show_page_number&&(d+=_),d+="<button id='jspsych-instructions-next' class='jspsych-btn'style='margin-left: 5px;'>"+e.button_label_next+" &gt;</button></div>",o+=d,t.innerHTML=o,i!=0&&e.allow_backward&&t.querySelector("#jspsych-instructions-back").addEventListener("click",y,{once:!0}),t.querySelector("#jspsych-instructions-next").addEventListener("click",y,{once:!0})}else e.show_page_number&&e.pages.length>1&&(o+="<div class='jspsych-instructions-pagenum'>"+_+"</div>"),t.innerHTML=o}function n(){l(),i++,i>=e.pages.length?w():u(),e.on_page_change(i)}function a(){l(),i--,u(),e.on_page_change(i)}function l(){var o=performance.now(),_=Math.round(o-p);s.push({page_index:i,viewing_time:_}),p=o}const w=()=>{e.allow_keys&&this.jsPsych.pluginAPI.cancelKeyboardResponse(c);var o={view_history:s,rt:Math.round(performance.now()-h)};this.jsPsych.finishTrial(o)},g=o=>{c=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:g,valid_responses:[e.key_forward,e.key_backward],rt_method:"performance",persist:!1,allow_held_key:!1}),this.jsPsych.pluginAPI.compareKeys(o.key,e.key_backward)&&i!==0&&e.allow_backward&&a(),this.jsPsych.pluginAPI.compareKeys(o.key,e.key_forward)&&n()};if(u(),e.allow_keys)var c=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:g,valid_responses:[e.key_forward,e.key_backward],rt_method:"performance",persist:!1})}simulate(t,e,i,s){e=="data-only"&&(s(),this.simulate_data_only(t,i)),e=="visual"&&this.simulate_visual(t,i,s)}create_simulation_data(t,e){var i,s,h,p,y,u;let n=0,a=0,l=[];if(!((i=e.data)!=null&&i.view_history)&&!((s=e.data)!=null&&s.rt))for(;n!==t.pages.length;){const c=Math.round(this.jsPsych.randomization.sampleExGaussian(3e3,300,.0033333333333333335));l.push({page_index:n,viewing_time:c}),a+=c,n==0||!t.allow_backward||this.jsPsych.randomization.sampleBernoulli(.9)==1?n++:n--}if(!((h=e.data)!=null&&h.view_history)&&(p=e.data)!=null&&p.rt){for(a=e.data.rt;n!==t.pages.length;)l.push({page_index:n,viewing_time:null}),n==0||!t.allow_backward||this.jsPsych.randomization.sampleBernoulli(.9)==1?n++:n--;const c=e.data.rt/l.length;let o=0;for(const m of l){const b=Math.round(this.jsPsych.randomization.sampleExGaussian(c,c/10,1/(c/10)));m.viewing_time=b,o+=b}const _=e.data.rt-o,d=Math.round(_/l.length);for(const m of l)m.viewing_time+=d}if((y=e.data)!=null&&y.view_history&&!((u=e.data)!=null&&u.rt)){l=e.data.view_history,a=0;for(const c of e.data.view_history)a+=c.viewing_time}const w={view_history:l,rt:a},g=this.jsPsych.pluginAPI.mergeSimulationData(w,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,g),g}simulate_data_only(t,e){const i=this.create_simulation_data(t,e);this.jsPsych.finishTrial(i)}simulate_visual(t,e,i){const s=this.create_simulation_data(t,e),h=this.jsPsych.getDisplayElement();this.trial(h,t),i();const p=a=>{t.allow_keys?this.jsPsych.pluginAPI.pressKey(t.key_forward,a):t.show_clickable_nav&&this.jsPsych.pluginAPI.clickTarget(h.querySelector("#jspsych-instructions-next"),a)},y=a=>{t.allow_keys?this.jsPsych.pluginAPI.pressKey(t.key_backward,a):t.show_clickable_nav&&this.jsPsych.pluginAPI.clickTarget(h.querySelector("#jspsych-instructions-back"),a)};let u=0,n=0;for(let a=0;a<s.view_history.length;a++)a==s.view_history.length-1?p(n+s.view_history[a].viewing_time):(s.view_history[a+1].page_index>u&&p(n+s.view_history[a].viewing_time),s.view_history[a+1].page_index<u&&y(n+s.view_history[a].viewing_time),n+=s.view_history[a].viewing_time,u=s.view_history[a+1].page_index)}}return v.info=P,v}(jsPsychModule);
//# sourceMappingURL=https://unpkg.com/@jspsych/plugin-instructions@2.1.0/dist/index.browser.min.js.map
